import "config.pkl"

hidden modules: List<String>

name = "Lint"

on = new config.OnTrigger {
    push = new config.PushTriggerConfig {
        branches = List(
            "main",
            "develop",
            "release/**"
        )
    }
    pull_request = new config.PullRequestTriggerConfig {
        branches = List(
            "main",
            "develop"
        )
    }
}

jobs = new Mapping {
    ["lint"] = new config.Job {
        strategy = new config.JobStrategy {
            matrix = new Mapping {
                ["module"] = modules
            }
        }
        steps = List(
            new config.ActionStep {
                uses = "actions/checkout@v3"
                with = new Mapping {
                    ["fetch-depth"] = 0
                }
            },
            new config.ActionStep {
                name = "Set up JDK 17"
                uses = "actions/setup-java@v3"
                with = new Mapping {
                    ["java-version"] = "17"
                    ["distribution"] = "temurin"
                }
            },
            new config.ActionStep {
                name = "Lint with Gradle"
                uses = "gradle/gradle-build-action@67421db6bd0bf253fb4bd25b31ebb98943c375e1"
                with = new Mapping {
                    ["arguments"] = "${{ matrix.module }}:lintVitalRelease"
                }
            }
        )
    }
}